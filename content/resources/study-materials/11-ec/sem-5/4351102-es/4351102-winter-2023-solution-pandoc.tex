\documentclass[10pt,a4paper]{article}
\input{../../../../../../latex-templates/gtu-solutions/preamble.tex}
\input{../../../../../../latex-templates/gtu-solutions/english-boxes.tex}

\begin{document}

\begin{center}
{\Huge\bfseries\color{headcolor} Subject Name Solutions}\\[5pt]
{\LARGE 4351102 -- Winter 2023}\\[3pt]
{\large Semester 1 Study Material}\\[3pt]
{\normalsize\textit{Detailed Solutions and Explanations}}
\end{center}

\vspace{10pt}

\subsection*{Question 1(a) [3 marks]}\label{q1a}

\textbf{Draw TIFR register and write its full name.}

\begin{solutionbox}

\textbf{TIFR Register Diagram:}

\begin{verbatim}
+{-{-}{-}{-}+{-}{-}{-}{-}+{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}+{-}{-}{-}{-}+{-}{-}{-}{-}+}
| 7  | 6  |  5 |  4  |  3  | 2  | 1  | 0  |
+{-{-}{-}{-}+{-}{-}{-}{-}+{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}+{-}{-}{-}{-}+{-}{-}{-}{-}+}
|OCF2|TOV2|ICF1|OCF1A|OCF1B|TOV1|OCF0|TOV0|
+{-{-}{-}{-}+{-}{-}{-}{-}+{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}+{-}{-}{-}{-}+{-}{-}{-}{-}+}
\end{verbatim}

\textbf{Full Name}: Timer/Counter Interrupt Flag Register

\begin{itemize}
\tightlist
\item
  \textbf{TOV0}: Timer0 Overflow Flag
\item
  \textbf{OCF0}: Timer0 Output Compare Flag
\item
  \textbf{TOV1}: Timer1 Overflow Flag
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Timer Interrupts Flag Register''

\end{mnemonicbox}
\subsection*{Question 1(b) [4 marks]}\label{q1b}

\textbf{Discuss data memory of ATmega32.}

\begin{solutionbox}

{\def\LTcaptype{none} % do not increment counter
\begin{longtable}[]{@{}llll@{}}
\toprule\noalign{}
Memory Type & Size & Address Range & Purpose \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
General Purpose Registers & 32 bytes & 0x00-0x1F & R0-R31 registers \\
I/O Memory & 64 bytes & 0x20-0x5F & Control registers \\
Internal SRAM & 2048 bytes & 0x60-0x85F & Variable storage \\
\end{longtable}
}

\begin{itemize}
\tightlist
\item
  \textbf{General Purpose Registers}: Used for arithmetic operations and
  temporary storage
\item
  \textbf{I/O Memory}: Contains peripheral control and status registers
\item
  \textbf{Internal SRAM}: Used for stack, variables, and dynamic memory
  allocation
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``General I/O SRAM Memory''

\end{mnemonicbox}
\subsection*{Question 1(c) [7 marks]}\label{q1c}

\textbf{Draw and explain general block diagram of embedded system.}

\begin{solutionbox}

\begin{center}
\textbf{Mermaid Diagram (Code)}
\begin{verbatim}
{Shaded}
{Highlighting}[]
graph TD
    A[Input Devices] {-{-}{} B[Processor/Microcontroller]}
    B {-{-}{} C[Memory]}
    B {-{-}{} D[Output Devices]}
    B {-{-}{} E[Communication Interface]}
    F[Power Supply] {-{-}{} B}
    G[Clock Circuit] {-{-}{} B}
{Highlighting}
{Shaded}
\end{verbatim}
\end{center}

{\def\LTcaptype{none} % do not increment counter
\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
Component & Function \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Processor & Controls entire system operation \\
Memory & Stores program and data \\
Input Devices & Sensors, switches, keyboards \\
Output Devices & LEDs, displays, motors \\
Communication & UART, SPI, I2C interfaces \\
\end{longtable}
}

\begin{itemize}
\tightlist
\item
  \textbf{Real-time Operation}: System responds to inputs within defined
  time limits
\item
  \textbf{Dedicated Function}: Designed for specific applications
\item
  \textbf{Resource Constraints}: Limited memory, power, and processing
  capability
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Processor Memory Input Output Communication''

\end{mnemonicbox}
\subsection*{Question 1(c OR) [7
marks]}\label{question-1c-or-7-marks}

\textbf{Define real time operating system and explain its
characteristics.}

\begin{solutionbox}

\textbf{Definition}: Real Time Operating System (RTOS) is an operating
system that guarantees response within specified time constraints for
critical tasks.

{\def\LTcaptype{none} % do not increment counter
\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
Characteristic & Description \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Deterministic & Predictable response times \\
Multitasking & Multiple tasks execution \\
Priority-based & High priority tasks first \\
Minimal Latency & Fast interrupt response \\
\end{longtable}
}

\begin{itemize}
\tightlist
\item
  \textbf{Hard Real-time}: Missing deadline causes system failure
\item
  \textbf{Soft Real-time}: Performance degrades if deadline missed
\item
  \textbf{Task Scheduling}: Preemptive priority-based scheduling ensures
  critical tasks run first
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Deterministic Multitasking Priority Minimal''

\end{mnemonicbox}
\subsection*{Question 2(a) [3 marks]}\label{q2a}

\textbf{Write Criteria for choosing microcontroller for embedded
system.}

\begin{solutionbox}

{\def\LTcaptype{none} % do not increment counter
\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
Criteria & Importance \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Processing Speed & Match application requirements \\
Memory Size & Sufficient ROM/RAM \\
I/O Pins & Adequate peripheral interfaces \\
Power Consumption & Battery life consideration \\
Cost & Budget constraints \\
Development Tools & Compiler, debugger availability \\
\end{longtable}
}

\end{solutionbox}
\begin{mnemonicbox}
``Speed Memory I/O Power Cost Tools''

\end{mnemonicbox}
\subsection*{Question 2(b) [4 marks]}\label{q2b}

\textbf{Discuss Harvard Architecture in the AVR.}

\begin{solutionbox}

\textbf{Harvard Architecture Features:}

{\def\LTcaptype{none} % do not increment counter
\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\linewidth - 2\tabcolsep) * \real{0.4091}}
  >{\raggedright\arraybackslash}p{(\linewidth - 2\tabcolsep) * \real{0.5909}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Feature
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Description
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Separate Buses & Program and data have independent buses \\
Simultaneous Access & Can fetch instruction and access data
simultaneously \\
Different Memory Types & Flash for program, SRAM for data \\
\end{longtable}
}

\begin{center}
\textbf{Mermaid Diagram (Code)}
\begin{verbatim}
{Shaded}
{Highlighting}[]
graph LR
    A[CPU] {-{-}{} B[Program Memory Bus]}
    A {-{-}{} C[Data Memory Bus]}
    B {-{-}{} D[Flash Memory]}
    C {-{-}{} E[SRAM]}
{Highlighting}
{Shaded}
\end{verbatim}
\end{center}

\begin{itemize}
\tightlist
\item
  \textbf{Advantage}: Higher performance due to parallel access
\item
  \textbf{16-bit Instructions}: Most instructions execute in single
  clock cycle
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Separate Simultaneous Different Performance''

\end{mnemonicbox}
\subsection*{Question 2(c) [7 marks]}\label{q2c}

\textbf{Discuss different ways of connecting clock sources to the AVR.}

\begin{solutionbox}

{\def\LTcaptype{none} % do not increment counter
\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
Clock Source & Frequency Range & Application \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
External Crystal & 1-16 MHz & High accuracy applications \\
External RC & 1-8 MHz & Cost-effective solution \\
Internal RC & 1-8 MHz & Default, no external components \\
External Clock & Up to 16 MHz & Synchronized systems \\
\end{longtable}
}

\textbf{Clock Selection via Fuse Bits:}

\begin{verbatim}
CKSEL3:0 bits determine clock source
CKDIV8 bit divides clock by 8
SUT1:0 bits set startup time
\end{verbatim}

\begin{itemize}
\tightlist
\item
  \textbf{Crystal Oscillator}: Most stable, requires external crystal
  and capacitors
\item
  \textbf{RC Oscillator}: Less accurate but cheaper
\item
  \textbf{Internal Oscillator}: Factory calibrated, temperature
  dependent
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Crystal RC Internal External''

\end{mnemonicbox}
\subsection*{Question 2(a OR) [3
marks]}\label{question-2a-or-3-marks}

\textbf{Write size of code ROM, SRAM and EEPROM, Number of I/O pins, ADC
and Timers for ATmega32.}

\begin{solutionbox}

{\def\LTcaptype{none} % do not increment counter
\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
Specification & ATmega32 \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Flash ROM & 32 KB \\
SRAM & 2 KB \\
EEPROM & 1 KB \\
I/O Pins & 32 pins \\
ADC Channels & 8 channels \\
Timers & 3 timers \\
\end{longtable}
}

\end{solutionbox}
\begin{mnemonicbox}
``32K Flash 2K SRAM 1K EEPROM 32 I/O 8 ADC 3 Timers''

\end{mnemonicbox}
\subsection*{Question 2(b OR) [4
marks]}\label{question-2b-or-4-marks}

\textbf{Draw ATmega32 pin diagram and write function of Vcc, AVcc and
Aref pin.}

\begin{solutionbox}

\textbf{Pin Functions:}

{\def\LTcaptype{none} % do not increment counter
\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
Pin & Function \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Vcc & Main power supply (+5V) \\
AVcc & Analog power supply for ADC \\
Aref & ADC reference voltage \\
\end{longtable}
}

\begin{verbatim}
        ATmega32
    +{-{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}+}
Vcc{-|1           40|{-}AVcc}
    |              |
    |              |
    |              |
    |              |
Aref|32          20|{-GND}
    +{-{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}+}
\end{verbatim}

\begin{itemize}
\tightlist
\item
  \textbf{Vcc}: Supplies power to digital circuits
\item
  \textbf{AVcc}: Separate supply for ADC to reduce noise
\item
  \textbf{Aref}: External reference for ADC conversion
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Vcc Digital AVcc Analog Aref Reference''

\end{mnemonicbox}
\subsection*{Question 2(c OR) [7
marks]}\label{question-2c-or-7-marks}

\textbf{Explain AVR status register in detail.}

\begin{solutionbox}

\textbf{SREG (Status Register) Bits:}

{\def\LTcaptype{none} % do not increment counter
\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
Bit & Name & Function \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
7 & I & Global Interrupt Enable \\
6 & T & Bit Copy Storage \\
5 & H & Half Carry Flag \\
4 & S & Sign Flag \\
3 & V & Overflow Flag \\
2 & N & Negative Flag \\
1 & Z & Zero Flag \\
0 & C & Carry Flag \\
\end{longtable}
}

\begin{verbatim}
+{-{-}{-}+{-}{-}{-}+{-}{-}{-}+{-}{-}{-}+{-}{-}{-}+{-}{-}{-}+{-}{-}{-}+{-}{-}{-}+}
| I | T | H | S | V | N | Z | C |
+{-{-}{-}+{-}{-}{-}+{-}{-}{-}+{-}{-}{-}+{-}{-}{-}+{-}{-}{-}+{-}{-}{-}+{-}{-}{-}+}
  7   6   5   4   3   2   1   0
\end{verbatim}

\begin{itemize}
\tightlist
\item
  \textbf{I Flag}: Controls global interrupt enable/disable
\item
  \textbf{Arithmetic Flags}: C, Z, N, V, S, H updated after ALU
  operations
\item
  \textbf{T Flag}: Used by BLD and BST instructions for bit manipulation
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``I Transfer Half Sign oVerflow Negative Zero Carry''

\end{mnemonicbox}
\subsection*{Question 3(a) [3 marks]}\label{q3a}

\textbf{Explain RESET circuit for the AVR microcontroller.}

\begin{solutionbox}

\textbf{Reset Sources:}

{\def\LTcaptype{none} % do not increment counter
\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
Reset Source & Description \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Power-on Reset & When power is applied \\
External Reset & Through RESET pin \\
Brown-out Reset & When voltage drops \\
Watchdog Reset & Watchdog timer overflow \\
\end{longtable}
}

\begin{verbatim}
Vcc {-{-}{-}{-}[R]{-}{-}{-}{-}+{-}{-}{-}{-} RESET pin}
               |
               C
               |
              GND
\end{verbatim}

\begin{itemize}
\tightlist
\item
  \textbf{Reset Duration}: Minimum 2 clock cycles
\item
  \textbf{Reset Vector}: Program starts from address 0x0000
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Power External Brown-out Watchdog''

\end{mnemonicbox}
\subsection*{Question 3(b) [4 marks]}\label{q3b}

\textbf{List I/O registers associated with EEPROM. Write programming
steps to write data on EEPROM.}

\begin{solutionbox}

\textbf{EEPROM Registers:}

{\def\LTcaptype{none} % do not increment counter
\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
Register & Function \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
EEAR & EEPROM Address Register \\
EEDR & EEPROM Data Register \\
EECR & EEPROM Control Register \\
\end{longtable}
}

\textbf{Programming Steps:}

\begin{enumerate}
\tightlist
\item
  Wait for previous write to complete (check EEWE bit)
\item
  Set address in EEAR register
\item
  Set data in EEDR register
\item
  Set EEMWE bit in EECR
\item
  Set EEWE bit within 4 clock cycles
\end{enumerate}

\end{solutionbox}
\begin{mnemonicbox}
``Wait Address Data Master-Write Enable-Write''

\end{mnemonicbox}
\subsection*{Question 3(c) [7 marks]}\label{q3c}

\textbf{Draw and explain TCCR0 register in detail.}

\begin{solutionbox}

\textbf{TCCR0 (Timer/Counter0 Control Register):}

{\def\LTcaptype{none} % do not increment counter
\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
Bit & Name & Function \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
7 & FOC0 & Force Output Compare \\
6,3 & WGM01,WGM00 & Waveform Generation Mode \\
5,4 & COM01,COM00 & Compare Output Mode \\
2,1,0 & CS02,CS01,CS00 & Clock Select \\
\end{longtable}
}

\begin{verbatim}
+{-{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}+}
|FOC0 |WGM01|COM01|COM00|WGM00|CS02 |CS01 |CS00 |
+{-{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}+}
  7     6     5     4     3     2     1     0
\end{verbatim}

\textbf{Clock Select Options:}

\begin{itemize}
\tightlist
\item
  000: No clock (Timer stopped)
\item
  001: clk/1 (No prescaling)
\item
  010: clk/8, 011: clk/64
\item
  100: clk/256, 101: clk/1024
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Force Waveform Compare Clock Select''

\end{mnemonicbox}
\subsection*{Question 3(a OR) [3
marks]}\label{question-3a-or-3-marks}

\textbf{List registers associated with Timer 1.}

\begin{solutionbox}

\textbf{Timer1 Registers:}

{\def\LTcaptype{none} % do not increment counter
\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
Register & Function \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
TCCR1A & Timer1 Control Register A \\
TCCR1B & Timer1 Control Register B \\
TCNT1H/L & Timer1 Counter Register \\
OCR1AH/L & Output Compare Register A \\
OCR1BH/L & Output Compare Register B \\
ICR1H/L & Input Capture Register \\
\end{longtable}
}

\end{solutionbox}
\begin{mnemonicbox}
``Control Counter Output-Compare Input-Capture''

\end{mnemonicbox}
\subsection*{Question 3(b OR) [4
marks]}\label{question-3b-or-4-marks}

\textbf{Write an AVR C program to store `G' into location 0x005F of
EEPROM.}

\begin{solutionbox}

\begin{verbatim}
\#include {avr/io.h}
\#include {avr/eeprom.h}

void eeprom\_write\_byte\_custom(uint16\_t addr, uint8\_t data)
\{
    while(EECR \& (1{}EEWE));  // Wait for previous write
    EEAR = addr;              // Set address
    EEDR = data;              // Set data
    EECR |= (1{}EEMWE);       // Master write enable
    EECR |= (1{}EEWE);        // Write enable
\}

int main()
\{
    eeprom\_write\_byte\_custom(0x005F, {G});
    return 0;
\}
\end{verbatim}

\textbf{Program Steps:}

\begin{itemize}
\tightlist
\item
  Check EEWE bit for completion
\item
  Load address 0x005F into EEAR
\item
  Load `G' (ASCII 71) into EEDR
\item
  Enable master write, then write enable
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Wait Address Data Master Write''

\end{mnemonicbox}
\subsection*{Question 3(c OR) [7
marks]}\label{question-3c-or-7-marks}

\textbf{Write a C program to toggle only the PORTB.4 bit continuously
every 70 μs. Use Timer0, Normal mode, and 1:8 prescaler to create the
delay. Assume XTAL = 8 MHz.}

\begin{solutionbox}

\begin{verbatim}
\#include {avr/io.h}

int main()
\{
    DDRB |= (1{}4);           // Set PB4 as output
    TCCR0 = 0x02;             // Prescaler 1:8
    
    while(1)
    \{
        TCNT0 = 186;          // Load initial value
        while(!(TIFR \& (1{}TOV0))); // Wait for overflow
        TIFR |= (1{}TOV0);    // Clear flag
        PORTB \^{=} (1{}4);      // Toggle PB4
    \}
    return 0;
\}
\end{verbatim}

\textbf{Calculation:}

\begin{itemize}
\tightlist
\item
  Clock = 8MHz/8 = 1MHz
\item
  For 70μs: Count = 70 cycles
\item
  Initial value = 256-70 = 186
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Direction Control Count Wait Clear Toggle''

\end{mnemonicbox}
\subsection*{Question 4(a) [3 marks]}\label{q4a}

\textbf{Write an AVR C program to monitor bit 5 of port C. If it is
HIGH, send 55H to Port B; otherwise, send AAH to Port B.}

\begin{solutionbox}

\begin{verbatim}
\#include {avr/io.h}

int main()
\{
    DDRC \&= {(}1{}5);          // PC5 as input
    DDRB = 0xFF;              // Port B as output
    
    while(1)
    \{
        if(PINC \& (1{}5))     // Check PC5
            PORTB = 0x55;     // Send 55H if HIGH
        else
            PORTB = 0xAA;     // Send AAH if LOW
    \}
    return 0;
\}
\end{verbatim}

\textbf{Program Logic:}

\begin{itemize}
\tightlist
\item
  Configure PC5 as input, Port B as output
\item
  Continuously check PC5 status
\item
  Output 0x55 or 0xAA based on input
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Direction Check Output''

\end{mnemonicbox}
\subsection*{Question 4(b) [4 marks]}\label{q4b}

\textbf{Draw and explain interfacing of LM35 with ATmega32.}

\begin{solutionbox}

\begin{center}
\textbf{Mermaid Diagram (Code)}
\begin{verbatim}
{Shaded}
{Highlighting}[]
graph LR
    A[LM35] {-{-}{} B[PA0/ADC0]}
    B {-{-}{} C[ATmega32]}
    D[+5V] {-{-}{} A}
    E[GND] {-{-}{} A}
{Highlighting}
{Shaded}
\end{verbatim}
\end{center}

\textbf{Connection Table:}

{\def\LTcaptype{none} % do not increment counter
\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
LM35 Pin & ATmega32 Pin & Function \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Vcc & +5V & Power supply \\
Output & PA0 (ADC0) & Analog voltage \\
GND & GND & Ground \\
\end{longtable}
}

\begin{itemize}
\tightlist
\item
  \textbf{Temperature Conversion}: 10mV/^\circC output
\item
  \textbf{ADC Resolution}: 10-bit (0-1023)
\item
  \textbf{Voltage Range}: 0V to 5V (0^\circC to 500^\circC)
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Power Output Ground Temperature''

\end{mnemonicbox}
\subsection*{Question 4(c) [7 marks]}\label{q4c}

\textbf{Draw and explain interfacing of MAX7221 with ATmega32.}

\begin{solutionbox}

\begin{center}
\textbf{Mermaid Diagram (Code)}
\begin{verbatim}
{Shaded}
{Highlighting}[]
graph LR
    A[ATmega32] {-{-}{} B[MAX7221]}
    A {-{-}{} C[7{-}Segment Display]}
    B {-{-}{} C}
{Highlighting}
{Shaded}
\end{verbatim}
\end{center}

\textbf{Connection Table:}

{\def\LTcaptype{none} % do not increment counter
\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
MAX7221 Pin & ATmega32 Pin & Function \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
DIN & MOSI (PB5) & Serial data input \\
CLK & SCK (PB7) & Serial clock \\
LOAD & SS (PB4) & Chip select \\
\end{longtable}
}

\textbf{Features:}

\begin{itemize}
\tightlist
\item
  \textbf{SPI Interface}: Serial communication protocol
\item
  \textbf{8-Digit Display}: Controls up to 8 seven-segment displays
\item
  \textbf{Built-in Decoder}: BCD to seven-segment conversion
\item
  \textbf{Brightness Control}: 16 intensity levels
\end{itemize}

\textbf{Programming Steps:}

\begin{enumerate}
\tightlist
\item
  Initialize SPI in master mode
\item
  Send address and data bytes
\item
  Pulse LOAD signal to latch data
\end{enumerate}

\end{solutionbox}
\begin{mnemonicbox}
``Serial Clock Load Display''

\end{mnemonicbox}
\subsection*{Question 4(a OR) [3
marks]}\label{question-4a-or-3-marks}

\textbf{Write an AVR C program to get a byte of data from Port B, and
then send it to Port C.}

\begin{solutionbox}

\begin{verbatim}
\#include {avr/io.h}

int main()
\{
    DDRB = 0x00;              // Port B as input
    DDRC = 0xFF;              // Port C as output
    
    uint8\_t data;
    
    while(1)
    \{
        data = PINB;          // Read from Port B
        PORTC = data;         // Send to Port C
    \}
    return 0;
\}
\end{verbatim}

\textbf{Program Function:}

\begin{itemize}
\tightlist
\item
  Configure Port B as input, Port C as output
\item
  Continuously read from PINB and write to PORTC
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Input Output Read Write''

\end{mnemonicbox}
\subsection*{Question 4(b OR) [4
marks]}\label{question-4b-or-4-marks}

\textbf{Draw and explain interfacing of ULN2803 with ATmega32.}

\begin{solutionbox}

\begin{center}
\textbf{Mermaid Diagram (Code)}
\begin{verbatim}
{Shaded}
{Highlighting}[]
graph LR
    A[ATmega32 Port] {-{-}{} B[ULN2803 Input]}
    B {-{-}{} C[ULN2803 Output]}
    C {-{-}{} D[Load/Relay]}
    E[Vcc] {-{-}{} D}
{Highlighting}
{Shaded}
\end{verbatim}
\end{center}

\textbf{ULN2803 Features:}

{\def\LTcaptype{none} % do not increment counter
\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
Feature & Description \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
8 Darlington Arrays & High current switching \\
Input Current & 500μA typical \\
Output Current & 500mA per channel \\
Built-in Flyback Diodes & Inductive load protection \\
\end{longtable}
}

\begin{itemize}
\tightlist
\item
  \textbf{Application}: Drive relays, motors, solenoids
\item
  \textbf{Voltage Drop}: 1.2V typical across Darlington pair
\item
  \textbf{Active Low Output}: Output goes low when input is high
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Darlington Current Protection Drive''

\end{mnemonicbox}
\subsection*{Question 4(c OR) [7
marks]}\label{question-4c-or-7-marks}

\textbf{Discuss registers used to program SPI in the AVR.}

\begin{solutionbox}

\textbf{SPI Registers:}

{\def\LTcaptype{none} % do not increment counter
\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
Register & Bits & Function \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
SPCR & SPE, DORD, MSTR, CPOL & SPI Control Register \\
SPSR & SPIF, WCOL, SPI2X & SPI Status Register \\
SPDR & - & SPI Data Register \\
\end{longtable}
}

\textbf{SPCR Register Bits:}

\begin{itemize}
\tightlist
\item
  \textbf{SPE}: SPI Enable
\item
  \textbf{DORD}: Data Order (MSB/LSB first)
\item
  \textbf{MSTR}: Master/Slave Select
\item
  \textbf{CPOL}: Clock Polarity
\item
  \textbf{CPHA}: Clock Phase
\end{itemize}

\textbf{SPSR Register Bits:}

\begin{itemize}
\tightlist
\item
  \textbf{SPIF}: SPI Interrupt Flag
\item
  \textbf{WCOL}: Write Collision Flag
\item
  \textbf{SPI2X}: Double Speed Mode
\end{itemize}

\textbf{Programming Sequence:}

\begin{enumerate}
\tightlist
\item
  Configure SPI pins as input/output
\item
  Set SPCR register for desired mode
\item
  Write data to SPDR
\item
  Wait for SPIF flag
\item
  Read received data from SPDR
\end{enumerate}

\end{solutionbox}
\begin{mnemonicbox}
``Control Status Data Enable Order Master''

\end{mnemonicbox}
\subsection*{Question 5(a) [3 marks]}\label{q5a}

\textbf{Draw and explain pin diagram of L293D motor driver IC.}

\begin{solutionbox}

\begin{verbatim}
        L293D
    +{-{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}+}
1EN{-|1        16|{-}Vcc1}
1A{-{-}|2        15|{-}4A}
1Y{-{-}|3        14|{-}4Y}
GND{-|4        13|{-}GND}
GND{-|5        12|{-}GND}
2Y{-{-}|6        11|{-}3Y}
2A{-{-}|7        10|{-}3A}
Vcc2|8         9|{-2EN}
    +{-{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}+}
\end{verbatim}

\textbf{Pin Functions:}

{\def\LTcaptype{none} % do not increment counter
\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
Pin & Function \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
1A, 2A & Input signals for Motor 1 \\
3A, 4A & Input signals for Motor 2 \\
1Y, 2Y & Output to Motor 1 \\
3Y, 4Y & Output to Motor 2 \\
1EN, 2EN & Enable pins for motors \\
Vcc1 & Logic supply (+5V) \\
Vcc2 & Motor supply (+12V) \\
\end{longtable}
}

\end{solutionbox}
\begin{mnemonicbox}
``Input Output Enable Logic Motor Supply''

\end{mnemonicbox}
\subsection*{Question 5(b) [4 marks]}\label{q5b}

\textbf{Draw and explain ADMUX register.}

\begin{solutionbox}

\textbf{ADMUX (ADC Multiplexer Selection Register):}

{\def\LTcaptype{none} % do not increment counter
\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
Bit & Name & Function \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
7,6 & REFS1,REFS0 & Reference Selection \\
5 & ADLAR & ADC Left Adjust Result \\
4-0 & MUX4-MUX0 & Analog Channel Selection \\
\end{longtable}
}

\begin{verbatim}
+{-{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}{-}+}
|REFS1 |REFS0 |ADLAR | MUX4 | MUX3 | MUX2 | MUX1 | MUX0 |
+{-{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}{-}+}
   7      6      5      4      3      2      1      0
\end{verbatim}

\textbf{Reference Selection:}

\begin{itemize}
\tightlist
\item
  00: AREF pin
\item
  01: AVcc with external capacitor
\item
  11: Internal 2.56V reference
\end{itemize}

\textbf{Channel Selection:} MUX bits select ADC0-ADC7 channels

\end{solutionbox}
\begin{mnemonicbox}
``Reference Adjust Multiplexer Channel''

\end{mnemonicbox}
\subsection*{Question 5(c) [7 marks]}\label{q5c}

\textbf{Explain GSM based security system.}

\begin{solutionbox}

\begin{center}
\textbf{Mermaid Diagram (Code)}
\begin{verbatim}
{Shaded}
{Highlighting}[]
graph LR
    A[Sensors] {-{-}{} B[Microcontroller]}
    B {-{-}{} C[GSM Module]}
    C {-{-}{} D[Mobile Network]}
    D {-{-}{} E[User Mobile]}
    F[Keypad] {-{-}{} B}
    G[Display] {-{-}{} B}
{Highlighting}
{Shaded}
\end{verbatim}
\end{center}

\textbf{System Components:}

{\def\LTcaptype{none} % do not increment counter
\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
Component & Function \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
PIR Sensor & Motion detection \\
Door Sensor & Entry detection \\
GSM Module & SMS/Call communication \\
Microcontroller & System control \\
Keypad & User interface \\
Display & Status indication \\
\end{longtable}
}

\textbf{Working Principle:}

\begin{enumerate}
\tightlist
\item
  Sensors detect intrusion
\item
  Microcontroller processes signal
\item
  GSM module sends SMS alert
\item
  User receives notification
\item
  System can be armed/disarmed remotely
\end{enumerate}

\textbf{Features:}

\begin{itemize}
\tightlist
\item
  \textbf{Remote Monitoring}: SMS notifications
\item
  \textbf{Multiple Sensors}: PIR, door, window sensors
\item
  \textbf{User Interface}: LCD display and keypad
\item
  \textbf{Emergency Response}: Automatic alert system
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Sensors Process Communicate Alert Control''

\end{mnemonicbox}
\subsection*{Question 5(a OR) [3
marks]}\label{question-5a-or-3-marks}

\textbf{Draw circuit diagram to interface DC motor with ATmega32 using
L293D motor driver.}

\begin{solutionbox}

\begin{verbatim}
ATmega32          L293D           DC Motor
    |               |               |
PA0 {-{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} 1A(2)         1Y(3) {-}{-}{-}{-}{-} Motor +}
PA1 {-{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} 2A(7)         2Y(6) {-}{-}{-}{-}{-} Motor {-}}
PA2 {-{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} 1EN(1)}
    |               |
   GND {-{-}{-}{-}{-}{-}{-}{-}{-}{-} GND(4,5,12,13)}
   +5V {-{-}{-}{-}{-}{-}{-}{-}{-}{-} Vcc1(16)}
   +12V {-{-}{-}{-}{-}{-}{-}{-}{-} Vcc2(8)}
\end{verbatim}

\textbf{Connection Table:}

{\def\LTcaptype{none} % do not increment counter
\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
ATmega32 & L293D & Function \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
PA0 & 1A (Pin 2) & Direction control 1 \\
PA1 & 2A (Pin 7) & Direction control 2 \\
PA2 & 1EN (Pin 1) & Motor enable \\
\end{longtable}
}

\textbf{Motor Control:}

\begin{itemize}
\tightlist
\item
  PA0=1, PA1=0: Clockwise rotation
\item
  PA0=0, PA1=1: Counter-clockwise rotation
\item
  PA2=0: Motor stop
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Direction Enable Control Stop''

\end{mnemonicbox}
\subsection*{Question 5(b OR) [4
marks]}\label{question-5b-or-4-marks}

\textbf{Draw and explain ADCSRA register.}

\begin{solutionbox}

\textbf{ADCSRA (ADC Control and Status Register A):}

{\def\LTcaptype{none} % do not increment counter
\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
Bit & Name & Function \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
7 & ADEN & ADC Enable \\
6 & ADSC & ADC Start Conversion \\
5 & ADATE & ADC Auto Trigger Enable \\
4 & ADIF & ADC Interrupt Flag \\
3 & ADIE & ADC Interrupt Enable \\
2-0 & ADPS2-ADPS0 & ADC Prescaler Select \\
\end{longtable}
}

\begin{verbatim}
+{-{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}+}
|ADEN |ADSC |ADATE|ADIF |ADIE |ADPS2|ADPS1|ADPS0|
+{-{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}+{-}{-}{-}{-}{-}+}
  7     6     5     4     3     2     1     0
\end{verbatim}

\textbf{Prescaler Selection:}

\begin{itemize}
\tightlist
\item
  000: Division factor 2
\item
  001: Division factor 2
\item
  010: Division factor 4
\item
  011: Division factor 8
\end{itemize}

\textbf{ADC Operation Steps:}

\begin{enumerate}
\tightlist
\item
  Set ADEN to enable ADC
\item
  Set ADSC to start conversion
\item
  Wait for ADIF flag
\item
  Read result from ADCH:ADCL
\end{enumerate}

\end{solutionbox}
\begin{mnemonicbox}
``Enable Start Auto Interrupt Prescaler''

\end{mnemonicbox}
\subsection*{Question 5(c OR) [7
marks]}\label{question-5c-or-7-marks}

\textbf{Explain Weather monitoring system.}

\begin{solutionbox}

\begin{center}
\textbf{Mermaid Diagram (Code)}
\begin{verbatim}
{Shaded}
{Highlighting}[]
graph TD
    A[Temperature Sensor] {-{-}{} E[Microcontroller]}
    B[Humidity Sensor] {-{-}{} E}
    C[Pressure Sensor] {-{-}{} E}
    D[Rain Sensor] {-{-}{} E}
    E {-{-}{} F[Display]}
    E {-{-}{} G[Data Logger]}
    E {-{-}{} H[Wireless Module]}
    H {-{-}{} I[Remote Monitor]}
{Highlighting}
{Shaded}
\end{verbatim}
\end{center}

\textbf{System Components:}

{\def\LTcaptype{none} % do not increment counter
\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
Sensor & Parameter & Interface \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
LM35 & Temperature & Analog (ADC) \\
DHT11 & Humidity & Digital \\
BMP180 & Pressure & I2C \\
Rain Sensor & Precipitation & Digital \\
\end{longtable}
}

\textbf{Features:}

\begin{itemize}
\tightlist
\item
  \textbf{Multi-parameter Monitoring}: Temperature, humidity, pressure,
  rainfall
\item
  \textbf{Data Logging}: Store readings in EEPROM/SD card
\item
  \textbf{Real-time Display}: LCD shows current readings
\item
  \textbf{Wireless Communication}: WiFi/GSM for remote monitoring
\item
  \textbf{Alert System}: Threshold-based warnings
\end{itemize}

\textbf{Applications:}

\begin{itemize}
\tightlist
\item
  Agricultural monitoring
\item
  Weather forecasting
\item
  Environmental research
\item
  Smart home automation
\end{itemize}

\textbf{System Benefits:}

\begin{itemize}
\tightlist
\item
  \textbf{Automated Data Collection}: Continuous monitoring
\item
  \textbf{Remote Access}: View data from anywhere
\item
  \textbf{Historical Analysis}: Trend identification
\item
  \textbf{Early Warning}: Extreme weather alerts
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Temperature Humidity Pressure Rain Display Log
Wireless''

\end{mnemonicbox}

\end{document}

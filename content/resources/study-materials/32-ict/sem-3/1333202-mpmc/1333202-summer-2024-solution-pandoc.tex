\documentclass[10pt,a4paper]{article}
\input{../../../../../../latex-templates/gtu-solutions/preamble.tex}
\input{../../../../../../latex-templates/gtu-solutions/english-boxes.tex}

\begin{document}

\begin{center}
{\Huge\bfseries\color{headcolor} Subject Name Solutions}\\[5pt]
{\LARGE 1333202 -- Summer 2024}\\[3pt]
{\large Semester 1 Study Material}\\[3pt]
{\normalsize\textit{Detailed Solutions and Explanations}}
\end{center}

\vspace{10pt}

\subsection*{Question 1(a) [3 marks]}\label{q1a}

\textbf{List common features of 8051 microcontroller.}

\begin{solutionbox}


{\def\LTcaptype{none} % do not increment counter
\vspace{-5pt}
\captionof{table}{Common Features of 8051 Microcontroller}
\vspace{-10pt}
\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
Feature & Description \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{On-chip Oscillator} & Built-in clock generator circuit \\
\textbf{Program Memory} & 4KB internal ROM for code storage \\
\textbf{Data Memory} & 128 bytes internal RAM \\
\textbf{I/O Ports} & 4 bidirectional 8-bit ports (P0-P3) \\
\textbf{Timers/Counters} & Two 16-bit Timer/Counter units \\
\textbf{Serial Port} & Full duplex UART communication \\
\textbf{Interrupts} & 5 interrupt sources with priority \\
\textbf{SFRs} & Special Function Registers for control \\
\end{longtable}
}

\end{solutionbox}
\begin{mnemonicbox}
``On Program Data I/O Timers Serial Interrupts SFRs''

\end{mnemonicbox}
\subsection*{Question 1(b) [4 marks]}\label{q1b}

\textbf{Define T-State, Machine Cycle, Instruction Cycle and Opcode.}

\begin{solutionbox}


{\def\LTcaptype{none} % do not increment counter
\vspace{-5pt}
\captionof{table}{Microprocessor Timing Definitions}
\vspace{-10pt}
\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\linewidth - 4\tabcolsep) * \real{0.2143}}
  >{\raggedright\arraybackslash}p{(\linewidth - 4\tabcolsep) * \real{0.4286}}
  >{\raggedright\arraybackslash}p{(\linewidth - 4\tabcolsep) * \real{0.3571}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Term
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Definition
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Duration
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{T-State} & One clock period of system clock & Basic timing
unit \\
\textbf{Machine Cycle} & Time to complete one memory operation & 3-6
T-states \\
\textbf{Instruction Cycle} & Time to fetch, decode and execute
instruction & 1-4 Machine cycles \\
\textbf{Opcode} & Operation code specifying instruction type & 1-3
bytes \\
\end{longtable}
}

\begin{itemize}
\tightlist
\item
  \textbf{T-State}: Smallest unit of time in microprocessor operation
\item
  \textbf{Machine Cycle}: Contains multiple T-states for memory access
\item
  \textbf{Instruction Cycle}: Complete instruction execution time
\item
  \textbf{Opcode}: Binary code identifying specific instruction
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Time Machine Instruction Operation''

\end{mnemonicbox}
\subsection*{Question 1(c) [7 marks]}\label{q1c}

\textbf{Compare Von-Neumann and Harvard Architecture.}

\begin{solutionbox}


{\def\LTcaptype{none} % do not increment counter
\vspace{-5pt}
\captionof{table}{Von-Neumann vs Harvard Architecture Comparison}
\vspace{-10pt}
\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\linewidth - 4\tabcolsep) * \real{0.3333}}
  >{\raggedright\arraybackslash}p{(\linewidth - 4\tabcolsep) * \real{0.3939}}
  >{\raggedright\arraybackslash}p{(\linewidth - 4\tabcolsep) * \real{0.2727}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Parameter
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Von-Neumann
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Harvard
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{Memory Organization} & Single memory for code and data &
Separate memory for code and data \\
\textbf{Bus Structure} & Single bus system & Dual bus system \\
\textbf{Speed} & Slower due to bus sharing & Faster parallel access \\
\textbf{Cost} & Lower cost implementation & Higher cost due to dual
memory \\
\textbf{Flexibility} & More flexible memory usage & Less flexible, fixed
allocation \\
\textbf{Examples} & 8085, x86 processors & 8051, DSP processors \\
\end{longtable}
}

\includegraphics[width=1\linewidth,height=\textheight,keepaspectratio]{mermaid-8dd60280.pdf}

\textbf{Key Differences:}

\begin{itemize}
\tightlist
\item
  \textbf{Memory Access}: Von-Neumann uses sequential access, Harvard
  allows simultaneous
\item
  \textbf{Performance}: Harvard is faster for embedded applications
\item
  \textbf{Applications}: Von-Neumann for general computing, Harvard for
  real-time systems
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Von-Single Harvard-Dual''

\end{mnemonicbox}
\subsection*{Question 1(c) OR [7
marks]}\label{q1c}

\textbf{Explain Microcomputer System with block diagram.}

\begin{solutionbox}

\textbf{Microcomputer System Components:}

\includegraphics[width=1\linewidth,height=\textheight,keepaspectratio]{mermaid-2a518517.pdf}


{\def\LTcaptype{none} % do not increment counter
\vspace{-5pt}
\captionof{table}{Microcomputer System Components}
\vspace{-10pt}
\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
Component & Function & Examples \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{CPU} & Central processing and control & 8085, 8086 \\
\textbf{Memory} & Program and data storage & RAM, ROM, EPROM \\
\textbf{I/O Unit} & Interface with external world & Keyboard, Display \\
\textbf{System Bus} & Data transfer pathway & Address, Data, Control \\
\end{longtable}
}

\begin{itemize}
\tightlist
\item
  \textbf{CPU}: Executes instructions and controls system operation
\item
  \textbf{Memory}: Stores programs and data for processing
\item
  \textbf{I/O}: Provides communication with external devices
\item
  \textbf{Bus}: Connects all components for data transfer
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``CPU Memory I/O Bus''

\end{mnemonicbox}
\subsection*{Question 2(a) [3 marks]}\label{q2a}

\textbf{Draw Bus organization in 8085 Microprocessor.}

\begin{solutionbox}

\begin{lstlisting}
    +----------+
    |   8085   |
    |   CPU    |
    +----------+
         |
    +----+----+
    |         |
    v         v
+--------+ +--------+
|Address | |  Data  |
|  Bus   | |  Bus   |
|16-bit  | | 8-bit  |
+--------+ +--------+
    |         |
    v         v
+--------+ +--------+
|Memory  | |  I/O   |
|System  | |Devices |
+--------+ +--------+
\end{lstlisting}


{\def\LTcaptype{none} % do not increment counter
\vspace{-5pt}
\captionof{table}{8085 Bus Organization}
\vspace{-10pt}
\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
Bus Type & Width & Function \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{Address Bus} & 16-bit & Memory addressing (64KB) \\
\textbf{Data Bus} & 8-bit & Data transfer \\
\textbf{Control Bus} & Multiple & Control signals \\
\end{longtable}
}

\end{solutionbox}
\begin{mnemonicbox}
``Address Data Control''

\end{mnemonicbox}
\subsection*{Question 2(b) [4 marks]}\label{q2b}

\textbf{List Flags used in 8085 and Explain working of each flags.}

\begin{solutionbox}


{\def\LTcaptype{none} % do not increment counter
\vspace{-5pt}
\captionof{table}{8085 Flags Register}
\vspace{-10pt}
\begin{longtable}[]{@{}llll@{}}
\toprule\noalign{}
Flag & Name & Bit Position & Function \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{S} & Sign & D7 & Set if result is negative \\
\textbf{Z} & Zero & D6 & Set if result is zero \\
\textbf{AC} & Auxiliary Carry & D4 & Set if carry from bit 3 to 4 \\
\textbf{P} & Parity & D2 & Set if result has even parity \\
\textbf{CY} & Carry & D0 & Set if carry/borrow occurs \\
\end{longtable}
}

\begin{lstlisting}
D7  D6  D5  D4  D3  D2  D1  D0
+---+---+---+---+---+---+---+---+
| S | Z | - |AC | - | P | - |CY |
+---+---+---+---+---+---+---+---+
\end{lstlisting}

\begin{itemize}
\tightlist
\item
  \textbf{Sign Flag}: Indicates negative result (MSB = 1)
\item
  \textbf{Zero Flag}: Set when arithmetic result is zero
\item
  \textbf{Auxiliary Carry}: Used for BCD arithmetic operations
\item
  \textbf{Parity Flag}: Checks even number of 1's in result
\item
  \textbf{Carry Flag}: Indicates overflow in arithmetic operations
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Sign Zero Auxiliary Parity Carry''

\end{mnemonicbox}
\subsection*{Question 2(c) [7 marks]}\label{q2c}

\textbf{Draw and Explain Block Diagram of 8085.}

\begin{solutionbox}

\includegraphics[width=1\linewidth,height=\textheight,keepaspectratio]{mermaid-7d782aa4.pdf}


{\def\LTcaptype{none} % do not increment counter
\vspace{-5pt}
\captionof{table}{8085 Block Components}
\vspace{-10pt}
\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
Block & Function & Size \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{ALU} & Arithmetic and logical operations & 8-bit \\
\textbf{Accumulator} & Primary register for operations & 8-bit \\
\textbf{Registers} & Data storage (B,C,D,E,H,L) & 8-bit each \\
\textbf{Program Counter} & Points to next instruction & 16-bit \\
\textbf{Stack Pointer} & Points to stack top & 16-bit \\
\textbf{Control Unit} & Instruction decode and control & - \\
\end{longtable}
}

\begin{itemize}
\tightlist
\item
  \textbf{Data Flow}: Instructions fetched via PC, decoded by CU,
  executed in ALU
\item
  \textbf{Register Operations}: Accumulator works with ALU, other
  registers store data
\item
  \textbf{Address Generation}: PC and SP provide 16-bit addresses
\item
  \textbf{Control Signals}: CU generates timing and control signals
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``ALU Accumulator Registers Program Stack Control''

\end{mnemonicbox}
\subsection*{Question 2(a) OR [3
marks]}\label{q2a}

\textbf{Explain Instruction Fetching, Decoding and Execution Operation
in microprocessor.}

\begin{solutionbox}

\includegraphics[width=1\linewidth,height=\textheight,keepaspectratio]{mermaid-55917faf.pdf}


{\def\LTcaptype{none} % do not increment counter
\vspace{-5pt}
\captionof{table}{Instruction Cycle Phases}
\vspace{-10pt}
\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
Phase & Operation & Duration \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{Fetch} & Get instruction from memory & 1 machine cycle \\
\textbf{Decode} & Interpret instruction opcode & Part of execute \\
\textbf{Execute} & Perform required operation & 1-3 machine cycles \\
\end{longtable}
}

\end{solutionbox}
\begin{mnemonicbox}
``Fetch Decode Execute''

\end{mnemonicbox}
\subsection*{Question 2(b) OR [4
marks]}\label{q2b}

\textbf{What is Demultiplexing of Lower order Address and Data lines in
8085? Explain using neat sketch.}

\begin{solutionbox}

\begin{lstlisting}
     8085
+-------------+
|  AD7-AD0    |  Multiplexed
+------+------+  Address/Data
       |
       v
+------+------+
|    ALE      |  Address Latch Enable
+------+------+
       |
       v
+------+------+
|   74LS373   |  Latch IC
+------+------+
   |       |
   v       v
A7-A0    D7-D0
Address   Data
\end{lstlisting}

\textbf{Demultiplexing Process:}

\begin{itemize}
\tightlist
\item
  \textbf{ALE Signal}: Controls separation of address and data
\item
  \textbf{Latch IC}: 74LS373 stores address when ALE is high
\item
  \textbf{Timing}: Address appears first, then data on same lines
\end{itemize}


{\def\LTcaptype{none} % do not increment counter
\vspace{-5pt}
\captionof{table}{Demultiplexing Components}
\vspace{-10pt}
\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
Component & Function & Timing \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{ALE} & Address Latch Enable signal & High during T1 \\
\textbf{74LS373} & Octal latch IC & Stores A7-A0 \\
\textbf{AD7-AD0} & Multiplexed lines & Address then Data \\
\end{longtable}
}

\end{solutionbox}
\begin{mnemonicbox}
``Address Latch Enable Demultiplexes Lines''

\end{mnemonicbox}
\subsection*{Question 2(c) OR [7
marks]}\label{q2c}

\textbf{Draw and Explain Pin Diagram of 8085.}

\begin{solutionbox}

\begin{lstlisting}
        8085 PIN DIAGRAM
    +-------------------+
X1  |1               40| VCC
X2  |2               39| HOLD
RST |3               38| HLDA
SOD |4               37| CLK
SID |5               36| RESET IN
TRAP|6               35| READY
RST7|7               34| IO/M
RST6|8               33| S1
RST5|9               32| RD
INTR|10              31| WR
INTA|11              30| ALE
AD0 |12              29| S0
AD1 |13              28| A15
AD2 |14              27| A14
AD3 |15              26| A13
AD4 |16              25| A12
AD5 |17              24| A11
AD6 |18              23| A10
AD7 |19              22| A9
VSS |20              21| A8
    +-------------------+
\end{lstlisting}


{\def\LTcaptype{none} % do not increment counter
\vspace{-5pt}
\captionof{table}{8085 Pin Functions}
\vspace{-10pt}
\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
Pin Group & Function & Count \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{Address Bus} & A8-A15 (Higher order) & 8 pins \\
\textbf{Address/Data} & AD0-AD7 (Multiplexed) & 8 pins \\
\textbf{Control Signals} & ALE, RD, WR, IO/M & 4 pins \\
\textbf{Interrupts} & TRAP, RST7.5, RST6.5, RST5.5, INTR & 5 pins \\
\textbf{Power} & VCC, VSS & 2 pins \\
\textbf{Clock} & X1, X2, CLK & 3 pins \\
\end{longtable}
}

\begin{itemize}
\tightlist
\item
  \textbf{Address Lines}: 16-bit addressing capability (64KB)
\item
  \textbf{Data Lines}: 8-bit data transfer
\item
  \textbf{Control Lines}: Memory and I/O operation control
\item
  \textbf{Interrupt Lines}: Hardware interrupt handling
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Address Data Control Interrupt Power Clock''

\end{mnemonicbox}
\subsection*{Question 3(a) [3 marks]}\label{q3a}

\textbf{Draw IP SFR of 8051 and Explain function of each bit.}

\begin{solutionbox}

\begin{lstlisting}
IP Register (Interrupt Priority) - Address B8H
MSB                           LSB
+---+---+---+----+---+----+----+----+
| - | - | - | PT2| PS| PT1| PX1| PX0|
+---+---+---+----+---+----+----+----+
 D7  D6  D5  D4  D3  D2  D1  D0
\end{lstlisting}


{\def\LTcaptype{none} % do not increment counter
\vspace{-5pt}
\captionof{table}{IP Register Bit Functions}
\vspace{-10pt}
\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
Bit & Name & Function \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{D4} & PT2 & Timer 2 interrupt priority \\
\textbf{D3} & PS & Serial port interrupt priority \\
\textbf{D2} & PT1 & Timer 1 interrupt priority \\
\textbf{D1} & PX1 & External interrupt 1 priority \\
\textbf{D0} & PX0 & External interrupt 0 priority \\
\end{longtable}
}

\begin{itemize}
\tightlist
\item
  \textbf{Priority Levels}: 1 = High priority, 0 = Low priority
\item
  \textbf{Default}: All interrupts have low priority (00H)
\item
  \textbf{Usage}: Set bit to 1 for high priority interrupt
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Timer2 Serial Timer1 External1 External0''

\end{mnemonicbox}
\subsection*{Question 3(b) [4 marks]}\label{q3b}

\textbf{Draw and explain Timer/Counter Logic diagram for 8051.}

\begin{solutionbox}

\includegraphics[width=1\linewidth,height=\textheight,keepaspectratio]{mermaid-39645642.pdf}


{\def\LTcaptype{none} % do not increment counter
\vspace{-5pt}
\captionof{table}{Timer Components}
\vspace{-10pt}
\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
Component & Function & Size \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{TH0/TL0} & Timer 0 high/low byte registers & 8-bit each \\
\textbf{TMOD} & Timer mode register & 8-bit \\
\textbf{TCON} & Timer control register & 8-bit \\
\textbf{TF0} & Timer 0 overflow flag & 1-bit \\
\end{longtable}
}

\begin{itemize}
\tightlist
\item
  \textbf{Clock Source}: Internal (system clock/12) or External (T0 pin)
\item
  \textbf{Operation}: Counts up from loaded value to FFH
\item
  \textbf{Overflow}: Sets TF0 flag and generates interrupt
\item
  \textbf{Modes}: 4 different timer modes available
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Timer High-Low Mode Control Flag''

\end{mnemonicbox}
\subsection*{Question 3(c) [7 marks]}\label{q3c}

\textbf{Draw and Explain Block Diagram of 8051.}

\begin{solutionbox}

\includegraphics[width=1\linewidth,height=\textheight,keepaspectratio]{mermaid-1347efdd.pdf}


{\def\LTcaptype{none} % do not increment counter
\vspace{-5pt}
\captionof{table}{8051 Block Components}
\vspace{-10pt}
\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
Block & Function & Specification \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{CPU} & Central processing unit & 8-bit processor \\
\textbf{Program Memory} & Code storage & 4KB internal ROM \\
\textbf{Data Memory} & Variable storage & 128 bytes RAM \\
\textbf{I/O Ports} & External interface & 4 ports (32 I/O lines) \\
\textbf{Timers} & Timing operations & 2 \times 16-bit timers \\
\textbf{Serial Port} & Communication & Full duplex UART \\
\textbf{Interrupts} & Event handling & 5 interrupt sources \\
\end{longtable}
}

\begin{itemize}
\tightlist
\item
  \textbf{Architecture}: Harvard architecture with separate program/data
  memory
\item
  \textbf{I/O Capability}: 32 bidirectional I/O lines
\item
  \textbf{On-chip Features}: Timers, serial port, interrupt system
\item
  \textbf{Memory}: Von-Neumann for data, Harvard for program
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``CPU Program Data I/O Timer Serial Interrupt''

\end{mnemonicbox}
\subsection*{Question 3(a) OR [3
marks]}\label{q3a}

\textbf{Draw PCON SFR of 8051 and Explain function of each bit.}

\begin{solutionbox}

\begin{lstlisting}
PCON Register (Power Control) - Address 87H
MSB                           LSB
+---+---+---+---+---+---+---+---+
|SMOD| - | - | - |GF1|GF0| PD|IDL|
+---+---+---+---+---+---+---+---+
 D7  D6  D5  D4  D3  D2  D1  D0
\end{lstlisting}


{\def\LTcaptype{none} % do not increment counter
\vspace{-5pt}
\captionof{table}{PCON Register Bit Functions}
\vspace{-10pt}
\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
Bit & Name & Function \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{D7} & SMOD & Serial port mode modifier \\
\textbf{D3} & GF1 & General purpose flag bit 1 \\
\textbf{D2} & GF0 & General purpose flag bit 0 \\
\textbf{D1} & PD & Power down mode control \\
\textbf{D0} & IDL & Idle mode control \\
\end{longtable}
}

\begin{itemize}
\tightlist
\item
  \textbf{SMOD}: Doubles serial port baud rate when set
\item
  \textbf{GF1, GF0}: User-defined flag bits
\item
  \textbf{PD}: Activates power-down mode
\item
  \textbf{IDL}: Activates idle mode
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Serial General Power Idle''

\end{mnemonicbox}
\subsection*{Question 3(b) OR [4
marks]}\label{q3b}

\textbf{In 8051 Serial communication Mode 1, For XTAL=11.0592 MHz, find
TH1 value needed to have for 9600 and 4800 baud rate.}

\begin{solutionbox}

\textbf{Formula for Mode 1 Baud Rate:}

\begin{lstlisting}
Baud Rate = (2^SMOD/32) \times (Timer1 Overflow Rate)
Timer1 Overflow Rate = XTAL/(12 \times (256 - TH1))
\end{lstlisting}

\textbf{For 9600 Baud Rate:}

\begin{lstlisting}
9600 = (1/32) \times (11059200/(12 \times (256 - TH1)))
9600 = 28800/(256 - TH1)
256 - TH1 = 3
TH1 = 253 = FDH
\end{lstlisting}

\textbf{For 4800 Baud Rate:}

\begin{lstlisting}
4800 = (1/32) \times (11059200/(12 \times (256 - TH1)))
4800 = 28800/(256 - TH1)
256 - TH1 = 6
TH1 = 250 = FAH
\end{lstlisting}


{\def\LTcaptype{none} % do not increment counter
\vspace{-5pt}
\captionof{table}{TH1 Values for Baud Rates}
\vspace{-10pt}
\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
Baud Rate & TH1 Value (Hex) & TH1 Value (Decimal) \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{9600} & FDH & 253 \\
\textbf{4800} & FAH & 250 \\
\end{longtable}
}

\end{solutionbox}
\begin{mnemonicbox}
``Higher Baud Higher TH1''

\end{mnemonicbox}
\subsection*{Question 4(a) [3 marks]}\label{q4a}

\textbf{What are the differences in LCALL and LJMP instructions in
8051?}

\begin{solutionbox}


{\def\LTcaptype{none} % do not increment counter
\vspace{-5pt}
\captionof{table}{LCALL vs LJMP Comparison}
\vspace{-10pt}
\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
Parameter & LCALL & LJMP \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{Function} & Long subroutine call & Long jump \\
\textbf{Stack Usage} & Pushes return address & No stack operation \\
\textbf{Return} & RET instruction needed & Direct jump only \\
\textbf{Bytes} & 3 bytes & 3 bytes \\
\textbf{Address Range} & 16-bit (64KB) & 16-bit (64KB) \\
\textbf{PC Action} & Saved then loaded & Directly loaded \\
\end{longtable}
}

\begin{itemize}
\tightlist
\item
  \textbf{LCALL}: Calls subroutine, saves return address on stack
\item
  \textbf{LJMP}: Unconditional jump to specified address
\item
  \textbf{Stack Impact}: LCALL uses 2 stack bytes, LJMP uses none
\item
  \textbf{Usage}: LCALL for functions, LJMP for program flow control
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Call Saves Jump Goes''

\end{mnemonicbox}
\subsection*{Question 4(b) [4 marks]}\label{q4b}

\textbf{Write 8051 Assembly Language Program to generate square wave on
port 1.0 using Timer0.}

\begin{solutionbox}

\begin{lstlisting}
ORG 0000H           ; Start address
LJMP MAIN           ; Jump to main program

ORG 0030H           ; Main program start
MAIN:
    MOV TMOD, #01H  ; Timer0 mode1 (16-bit)
    MOV TH0, #HIGH(-50000)  ; Load high byte
    MOV TL0, #LOW(-50000)   ; Load low byte
    SETB TR0        ; Start Timer0

LOOP:
    JNB TF0, LOOP   ; Wait for overflow
    CLR TF0         ; Clear overflow flag
    CPL P1.0        ; Toggle P1.0
    MOV TH0, #HIGH(-50000)  ; Reload timer
    MOV TL0, #LOW(-50000)   ; Reload timer
    SJMP LOOP       ; Repeat

END
\end{lstlisting}

\textbf{Program Explanation:}

\begin{itemize}
\tightlist
\item
  \textbf{Timer Setup}: Mode 1 (16-bit timer)
\item
  \textbf{Count Value}: -50000 for specific delay
\item
  \textbf{Square Wave}: Toggle P1.0 on each overflow
\item
  \textbf{Continuous}: Loop maintains square wave
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Mode Load Start Wait Toggle Reload''

\end{mnemonicbox}
\subsection*{Question 4(c) [7 marks]}\label{q4c}

\textbf{Explain any three Logical and any four Data Transfer Instruction
of 8051 with example.}

\begin{solutionbox}


{\def\LTcaptype{none} % do not increment counter
\vspace{-5pt}
\captionof{table}{Logical Instructions}
\vspace{-10pt}
\begin{longtable}[]{@{}llll@{}}
\toprule\noalign{}
Instruction & Function & Example & Result \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{ANL} & Logical AND & ANL A, \#0FH & A = A AND 0FH \\
\textbf{ORL} & Logical OR & ORL A, \#F0H & A = A OR F0H \\
\textbf{XRL} & Logical XOR & XRL A, \#FFH & A = A XOR FFH \\
\end{longtable}
}


{\def\LTcaptype{none} % do not increment counter
\vspace{-5pt}
\captionof{table}{Data Transfer Instructions}
\vspace{-10pt}
\begin{longtable}[]{@{}llll@{}}
\toprule\noalign{}
Instruction & Function & Example & Operation \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{MOV} & Move data & MOV A, \#50H & Load 50H into A \\
\textbf{MOVX} & Move external & MOVX A, @DPTR & Load from external
memory \\
\textbf{PUSH} & Push to stack & PUSH ACC & Push accumulator to stack \\
\textbf{POP} & Pop from stack & POP ACC & Pop from stack to
accumulator \\
\end{longtable}
}

\textbf{Detailed Examples:}

\begin{lstlisting}
; Logical Instructions
ANL A, #0FH     ; Mask upper nibble
ORL P1, #80H    ; Set bit 7 of Port1
XRL A, #FFH     ; Complement accumulator

; Data Transfer Instructions
MOV R0, #30H    ; Load immediate data
MOVX @DPTR, A   ; Store to external memory
PUSH B          ; Save B register
POP PSW         ; Restore status word
\end{lstlisting}

\end{solutionbox}
\begin{mnemonicbox}
``AND OR XOR Move External Push Pop''

\end{mnemonicbox}
\subsection*{Question 4(a) OR [3
marks]}\label{q4a}

\textbf{Explain Instructions: (i) RRC A (ii) POP (iii) CLR PSW.7}

\begin{solutionbox}


{\def\LTcaptype{none} % do not increment counter
\vspace{-5pt}
\captionof{table}{Instruction Explanations}
\vspace{-10pt}
\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\linewidth - 6\tabcolsep) * \real{0.3023}}
  >{\raggedright\arraybackslash}p{(\linewidth - 6\tabcolsep) * \real{0.2326}}
  >{\raggedright\arraybackslash}p{(\linewidth - 6\tabcolsep) * \real{0.2558}}
  >{\raggedright\arraybackslash}p{(\linewidth - 6\tabcolsep) * \real{0.2093}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Instruction
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Function
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Operation
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Example
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{RRC A} & Rotate right through carry & A\rightarrowC, C\rightarrowA(MSB) & A=85H,C=0
\rightarrow A=42H,C=1 \\
\textbf{POP} & Pop from stack & SP\rightarrowRegister, SP-1 & POP ACC \\
\textbf{CLR PSW.7} & Clear bit 7 of PSW & PSW.7 = 0 & Clear CY flag \\
\end{longtable}
}

\begin{lstlisting}
RRC A Operation:
Before:

A = [D7 D6 D5 D4 D3 D2 D1 D0]

C = [C]

After:

A = [C  D7 D6 D5 D4 D3 D2 D1]

C = [D0]

\end{lstlisting}

\begin{itemize}
\tightlist
\item
  \textbf{RRC A}: Rotates accumulator right through carry flag
\item
  \textbf{POP}: Removes top stack element into specified register
\item
  \textbf{CLR PSW.7}: Clears carry flag (bit 7 of Program Status Word)
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Rotate Pop Clear''

\end{mnemonicbox}
\subsection*{Question 4(b) OR [4
marks]}\label{q4b}

\textbf{Write 8051 Assembly Language Program to Divide data stored in
location 30H by data stored in location 31H and store remainder in 40h
and quotient in 41h memory location.}

\begin{solutionbox}

\begin{lstlisting}
ORG 0000H           ; Program start
LJMP MAIN

ORG 0030H
MAIN:
    MOV A, 30H      ; Load dividend
    MOV B, 31H      ; Load divisor
    DIV AB          ; Divide A by B
    MOV 41H, A      ; Store quotient
    MOV 40H, B      ; Store remainder
    SJMP $          ; Stop here

END
\end{lstlisting}

\textbf{Program Steps:}

\begin{enumerate}
\tightlist
\item
  \textbf{Load Data}: Move dividend and divisor to A and B
\item
  \textbf{Division}: Use DIV AB instruction
\item
  \textbf{Store Results}: Quotient in A, remainder in B
\item
  \textbf{Save}: Store results in specified memory locations
\end{enumerate}


{\def\LTcaptype{none} % do not increment counter
\vspace{-5pt}
\captionof{table}{DIV AB Instruction}
\vspace{-10pt}
\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
Before & After \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
A = Dividend &

A = Quotient \\

B = Divisor &

B = Remainder \\

\end{longtable}
}

\end{solutionbox}
\begin{mnemonicbox}
``Load Divide Store''

\end{mnemonicbox}
\subsection*{Question 4(c) OR [7
marks]}\label{q4c}

\textbf{List Addressing Modes of 8051 Microcontroller and Explain each
with Example.}

\begin{solutionbox}


{\def\LTcaptype{none} % do not increment counter
\vspace{-5pt}
\captionof{table}{8051 Addressing Modes}
\vspace{-10pt}
\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\linewidth - 6\tabcolsep) * \real{0.1463}}
  >{\raggedright\arraybackslash}p{(\linewidth - 6\tabcolsep) * \real{0.3171}}
  >{\raggedright\arraybackslash}p{(\linewidth - 6\tabcolsep) * \real{0.2195}}
  >{\raggedright\arraybackslash}p{(\linewidth - 6\tabcolsep) * \real{0.3171}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Mode
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Description
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Example
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Explanation
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{Immediate} & Data in instruction & MOV A, \#50H & Load 50H into
A \\
\textbf{Register} & Use register & MOV A, R0 & Move R0 content to A \\
\textbf{Direct} & Memory address specified & MOV A, 30H & Load from
address 30H \\
\textbf{Indirect} & Address in register & MOV A, @R0 & Load from address
in R0 \\
\textbf{Indexed} & Base + offset & MOVC A, @A+DPTR & A = content of
(A+DPTR) \\
\textbf{Relative} & PC + offset & SJMP HERE & Jump relative to PC \\
\textbf{Bit} & Bit address & SETB P1.0 & Set bit 0 of Port 1 \\
\end{longtable}
}

\textbf{Detailed Examples:}

\begin{lstlisting}
; Immediate Addressing
MOV A, #25H         ; Load immediate value 25H

; Register Addressing  
MOV A, R7           ; Move register R7 to A

; Direct Addressing
MOV A, 40H          ; Load from memory location 40H

; Indirect Addressing
MOV R0, #50H        ; R0 points to address 50H
MOV A, @R0          ; Load from address pointed by R0

; Indexed Addressing
MOV DPTR, #TABLE    ; Point to lookup table
MOVC A, @A+DPTR     ; Load from table[A]

; Relative Addressing
SJMP NEXT           ; Jump to label NEXT

; Bit Addressing
SETB P2.5           ; Set bit 5 of Port 2
\end{lstlisting}

\end{solutionbox}
\begin{mnemonicbox}
``Immediate Register Direct Indirect Indexed Relative
Bit''

\end{mnemonicbox}
\subsection*{Question 5(a) [3 marks]}\label{q5a}

\textbf{Draw Interfacing of Relay with 8051 microcontroller.}

\begin{solutionbox}

\begin{lstlisting}
    8051 Port Pin
         |
         |
    +----+----+
    |  2.2K   |  Resistor
    +----+----+
         |
    +----+----+  Base
    |  NPN    |  Transistor
    |   BC547 |  
    +----+----+
         |     Collector
         |
    +----+----+
    |  Relay  |  12V Relay
    |  Coil   |
    +----+----+
         |
       +VCC (12V)
    
    Relay Contacts
    +----+----+
    | NO | NC |  Load Connection
    +----+----+
\end{lstlisting}


{\def\LTcaptype{none} % do not increment counter
\vspace{-5pt}
\captionof{table}{Interface Components}
\vspace{-10pt}
\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
Component & Function & Value \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{Transistor} & Current amplifier & BC547 NPN \\
\textbf{Resistor} & Base current limiter & 2.2KΩ \\
\textbf{Relay} & Electromagnetic switch & 12V DC \\
\textbf{Diode} & Back EMF protection & 1N4007 \\
\end{longtable}
}

\begin{itemize}
\tightlist
\item
  \textbf{Operation}: Port pin HIGH \rightarrow Transistor ON \rightarrow Relay energized
\item
  \textbf{Protection}: Diode prevents back EMF damage
\item
  \textbf{Isolation}: Relay provides electrical isolation
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Transistor Resistor Relay Diode''

\end{mnemonicbox}
\subsection*{Question 5(b) [4 marks]}\label{q5b}

\textbf{Interface 7 Segment display with 8051 microcontroller and write
a program to print ``1'' on it.}

\begin{solutionbox}

\begin{lstlisting}
    8051 Port 1
P1.0 ----[330Ω]---- a
P1.1 ----[330Ω]---- b  
P1.2 ----[330Ω]---- c
P1.3 ----[330Ω]---- d
P1.4 ----[330Ω]---- e
P1.5 ----[330Ω]---- f
P1.6 ----[330Ω]---- g
P1.7 ----[330Ω]---- dp

    7-Segment Display
     aaaa
    f    b
    f    b
     gggg
    e    c
    e    c
     dddd  dp
\end{lstlisting}

\textbf{Program to Display ``1'':}

\begin{lstlisting}
ORG 0000H
LJMP MAIN

ORG 0030H
MAIN:
    MOV P1, #06H    ; Display "1" (segments b,c ON)
    SJMP $          ; Stop here

; Pattern for "1": 00000110 = 06H
; Only segments b and c are ON

END
\end{lstlisting}


{\def\LTcaptype{none} % do not increment counter
\vspace{-5pt}
\captionof{table}{7-Segment Display Components}
\vspace{-10pt}
\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
Component & Function & Value \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{Current Limiting Resistor} & Protect LED segments & 330Ω \\
\textbf{Port Connection} & Digital output control & Port 1 \\
\textbf{Display Pattern} & Segment control & Binary pattern \\
\end{longtable}
}

\end{solutionbox}
\begin{mnemonicbox}
``Current Limit Segment Pattern''

\end{mnemonicbox}
\subsection*{Question 5(c) [7 marks]}\label{q5c}

\textbf{Interface DAC 0808 with 8051 microcontroller and write a program
to generate Square wave.}

\begin{solutionbox}

\begin{lstlisting}
    8051           DAC0808
Port 2     +---------------+
P2.0 ----->| D0        IOUT|---[10KΩ]---+---> Vout
P2.1 ----->| D1            |            |
P2.2 ----->| D2        IREF|---[10KΩ]---+
P2.3 ----->| D3            |            |
P2.4 ----->| D4         VCC|---(+5V)    |
P2.5 ----->| D5         VEE|---(-5V)    |
P2.6 ----->| D6            |            |
P2.7 ----->| D7         GND|---(GND)    |
           +---------------+            |
                                        |
                                 Op-Amp Buffer
                                      |
                                   Output
\end{lstlisting}

\textbf{Program to Generate Square Wave:}

\begin{lstlisting}
ORG 0000H
LJMP MAIN

ORG 0030H
MAIN:
    MOV A, #00H     ; Minimum value (0V)
    MOV P2, A       ; Output to DAC
    CALL DELAY      ; Wait period
    
    MOV A, #0FFH    ; Maximum value (approx 5V)
    MOV P2, A       ; Output to DAC
    CALL DELAY      ; Wait period
    
    SJMP MAIN       ; Repeat for square wave

DELAY:
    MOV R0, #200    ; Delay counter
LOOP1:
    MOV R1, #250    ; Inner loop counter
LOOP2:
    DJNZ R1, LOOP2  ; Inner delay loop
    DJNZ R0, LOOP1  ; Outer delay loop
    RET

END
\end{lstlisting}


{\def\LTcaptype{none} % do not increment counter
\vspace{-5pt}
\captionof{table}{DAC Interface Specifications}
\vspace{-10pt}
\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
Parameter & Value & Function \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{Resolution} & 8-bit & 256 output levels \\
\textbf{Reference Voltage} & 5V & Full scale output \\
\textbf{Output Range} & 0-5V & Analog voltage range \\
\textbf{Interface Type} & Parallel & 8-bit data bus \\
\end{longtable}
}

\textbf{Square Wave Generation:}

\begin{itemize}
\tightlist
\item
  \textbf{Low Level}: 00H produces approximately 0V output
\item
  \textbf{High Level}: FFH produces approximately 5V output
\item
  \textbf{Frequency}: Determined by delay routine duration
\item
  \textbf{Output}: Clean analog square wave at DAC output
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Digital Analog Convert Square''

\end{mnemonicbox}
\subsection*{Question 5(a) OR [3
marks]}\label{q5a}

\textbf{Interface of Push button Switch with 8051 microcontroller.}

\begin{solutionbox}

\begin{lstlisting}
         +5V
          |
          |
     +----+----+
     |   10K   |  Pull-up Resistor
     +----+----+
          |
          +-------- P1.0 (8051 Port Pin)
          |
     +----+----+
     |   SW    |  Push Button Switch
     +----+----+
          |
         GND
\end{lstlisting}


{\def\LTcaptype{none} % do not increment counter
\vspace{-5pt}
\captionof{table}{Push Button Interface Components}
\vspace{-10pt}
\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
Component & Value & Function \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{Pull-up Resistor} & 10KΩ & Ensures logic HIGH when switch
open \\
\textbf{Push Button} & SPST Momentary & User input device \\
\textbf{Logic Levels} & HIGH=1, LOW=0 & Switch open=1, pressed=0 \\
\end{longtable}
}

\textbf{Sample Program:}

\begin{lstlisting}
CHECK_SWITCH:
    JB P1.0, SW_RELEASED    ; Jump if switch not pressed
    ; Switch pressed code here
    CALL SWITCH_PRESSED
    SJMP CHECK_SWITCH

SW_RELEASED:
    ; Switch not pressed code here
    SJMP CHECK_SWITCH

SWITCH_PRESSED:
    ; Action when switch is pressed
    RET
\end{lstlisting}

\textbf{Operation:}

\begin{itemize}
\tightlist
\item
  \textbf{Switch Open}: Pull-up resistor makes pin HIGH (logic 1)
\item
  \textbf{Switch Pressed}: Pin connected to GND, becomes LOW (logic 0)
\item
  \textbf{Debouncing}: May require software debouncing for reliable
  operation
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Pull-up Switch Ground''

\end{mnemonicbox}
\subsection*{Question 5(b) OR [4
marks]}\label{q5b}

\textbf{Interface DC Motor with 8051 microcontroller.}

\begin{solutionbox}

\begin{lstlisting}
    8051 Port Pin (P1.0)
         |
    +----+----+
    |   1K    |  Base Resistor
    +----+----+
         |
    +----+----+  Base
    |  NPN    |  Power Transistor
    | TIP122  |  (Darlington)
    +----+----+
         |     Collector
         |
    +----+----+
    |   DC    |  12V DC Motor
    |  Motor  |
    +----+----+
         |
       +VCC (12V)
    
    +----+----+  Freewheeling Diode
    | 1N4007  |  (Across Motor)
    +----+----+
\end{lstlisting}

\textbf{Motor Control Program:}

\begin{lstlisting}
MOTOR_ON:
    SETB P1.0       ; Turn motor ON
    RET

MOTOR_OFF:
    CLR P1.0        ; Turn motor OFF
    RET

MOTOR_SPEED_CONTROL:
    ; PWM for speed control
    SETB P1.0       ; Motor ON
    CALL DELAY_ON   ; ON time duration
    CLR P1.0        ; Motor OFF  
    CALL DELAY_OFF  ; OFF time duration
    RET

DELAY_ON:
    MOV R0, #100    ; ON time delay
    DJNZ R0, $
    RET

DELAY_OFF:
    MOV R0, #50     ; OFF time delay  
    DJNZ R0, $
    RET
\end{lstlisting}


{\def\LTcaptype{none} % do not increment counter
\vspace{-5pt}
\captionof{table}{DC Motor Interface Components}
\vspace{-10pt}
\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\linewidth - 4\tabcolsep) * \real{0.3056}}
  >{\raggedright\arraybackslash}p{(\linewidth - 4\tabcolsep) * \real{0.2778}}
  >{\raggedright\arraybackslash}p{(\linewidth - 4\tabcolsep) * \real{0.4167}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Component
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Function
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Specification
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{Power Transistor} & Current amplification & TIP122 (Darlington
pair) \\
\textbf{Base Resistor} & Current limiting & 1KΩ \\
\textbf{Freewheeling Diode} & Back EMF protection & 1N4007 \\
\textbf{DC Motor} & Load device & 12V DC Motor \\
\end{longtable}
}

\textbf{Operation Principle:}

\begin{itemize}
\tightlist
\item
  \textbf{Motor ON}: Port pin HIGH \rightarrow Transistor saturated \rightarrow Motor runs
\item
  \textbf{Motor OFF}: Port pin LOW \rightarrow Transistor cut-off \rightarrow Motor stops
\item
  \textbf{Speed Control}: PWM technique varies average power to motor
\item
  \textbf{Protection}: Diode protects transistor from back EMF
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Transistor Resistor Diode Motor''

\end{mnemonicbox}
\subsection*{Question 5(c) OR [7
marks]}\label{q5c}

\textbf{Interface LCD with 8051 microcontroller and write a program to
display ``Hello''.}

\begin{solutionbox}

\begin{lstlisting}
    8051        16x2 LCD Display
Port 2      +-------------------+
P2.0 ------>| D4          VCC   |---(+5V)
P2.1 ------>| D5          VDD   |---(GND)
P2.2 ------>| D6          V0    |---(Contrast Adj)
P2.3 ------>| D7          RS    |<--- P3.0
            |             EN    |<--- P3.1
            |             R/W   |---(GND)
            +-------------------+
\end{lstlisting}

\textbf{Complete LCD Interface Program:}

\begin{lstlisting}
ORG 0000H
LJMP MAIN

ORG 0030H
MAIN:
    CALL LCD_INIT       ; Initialize LCD
    MOV DPTR, #MESSAGE  ; Point to message string
    CALL DISPLAY_STRING ; Display the message
    SJMP $              ; Stop execution

LCD_INIT:
    CALL DELAY_15MS     ; Wait 15ms after power on
    MOV A, #38H         ; Function set: 8-bit mode, 2 lines, 5x7 matrix
    CALL COMMAND_WRITE
    MOV A, #0EH         ; Display on, cursor on, blink off
    CALL COMMAND_WRITE
    MOV A, #01H         ; Clear display
    CALL COMMAND_WRITE
    MOV A, #06H         ; Entry mode: increment cursor, no shift
    CALL COMMAND_WRITE
    RET

COMMAND_WRITE:
    MOV P2, A           ; Send command to data lines (D4-D7)
    CLR P3.0            ; RS = 0 for command
    SETB P3.1           ; Enable pulse high
    CALL DELAY_1MS
    CLR P3.1            ; Enable pulse low
    CALL DELAY_1MS
    RET

DATA_WRITE:
    MOV P2, A           ; Send data to data lines (D4-D7)
    SETB P3.0           ; RS = 1 for data
    SETB P3.1           ; Enable pulse high
    CALL DELAY_1MS
    CLR P3.1            ; Enable pulse low
    CALL DELAY_1MS
    RET

DISPLAY_STRING:
    CLR A
    MOVC A, @A+DPTR     ; Get character from string
    JZ STRING_END       ; If zero, end of string
    CALL DATA_WRITE     ; Display character
    INC DPTR            ; Point to next character
    SJMP DISPLAY_STRING ; Continue until end

STRING_END:
    RET

MESSAGE: DB "HELLO", 0  ; Message string with null terminator

DELAY_1MS:
    MOV R0, #4          ; Outer loop counter
DEL1: 
    MOV R1, #250        ; Inner loop counter  
DEL2: 
    DJNZ R1, DEL2       ; Inner delay loop
    DJNZ R0, DEL1       ; Outer delay loop
    RET

DELAY_15MS:
    MOV R2, #15         ; 15ms delay counter
DEL15: 
    CALL DELAY_1MS      ; Call 1ms delay
    DJNZ R2, DEL15      ; Repeat 15 times
    RET

END
\end{lstlisting}


{\def\LTcaptype{none} % do not increment counter
\vspace{-5pt}
\captionof{table}{LCD Control Signals}
\vspace{-10pt}
\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
Signal & Pin & Function \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{RS} & P3.0 & Register Select (0=Command, 1=Data) \\
\textbf{EN} & P3.1 & Enable pulse for data latch \\
\textbf{R/W} & GND & Read/Write (tied to GND for write only) \\
\textbf{D4-D7} & P2.0-P2.3 & 4-bit data bus (upper nibble) \\
\end{longtable}
}


{\def\LTcaptype{none} % do not increment counter
\vspace{-5pt}
\captionof{table}{Important LCD Commands}
\vspace{-10pt}
\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
Command & Hex Code & Function \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{Function Set} & 38H & 8-bit mode, 2 lines, 5x7 matrix \\
\textbf{Display Control} & 0EH & Display ON, cursor ON, blink OFF \\
\textbf{Clear Display} & 01H & Clear entire display \\
\textbf{Entry Mode} & 06H & Increment cursor, no display shift \\
\end{longtable}
}

\textbf{LCD Display Process:}

\begin{enumerate}
\tightlist
\item
  \textbf{Initialization}: Configure LCD parameters and clear display
\item
  \textbf{Command Mode}: Send commands with RS=0
\item
  \textbf{Data Mode}: Send characters with RS=1\\
\item
  \textbf{Enable Pulse}: Latch data/command with EN signal
\item
  \textbf{String Display}: Loop through message characters until null
  terminator
\end{enumerate}

\textbf{Character Display Steps:}

\begin{itemize}
\tightlist
\item
  Set RS=1 for data mode
\item
  Put character code on data bus
\item
  Generate enable pulse (HIGH to LOW)
\item
  Wait for LCD to process (1ms delay)
\item
  Repeat for next character
\end{itemize}

\end{solutionbox}
\begin{mnemonicbox}
``Initialize Command Data Enable Display''

\end{mnemonicbox}

\end{document}
